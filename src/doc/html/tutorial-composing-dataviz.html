<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Tutorial - Composing Data Visualizations with Britecharts</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/britecharts/dist/css/britecharts.min.css"
        type="text/css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-selection/1.2.0/d3-selection.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/britecharts@2.10.0/dist/bundled/britecharts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.11/lodash.min.js" type="text/javascript" /></script>
</head>

<body>
    <section style="padding: 50px;">
        <h1>Composing a Data Visualization</h1>
        <div class="line-container"></div>
    </section>

    <script>
        // Instantiate Line Chart
        const lineChart = britecharts.line();
        const container = d3.select('.line-container');
        const containerWidth = container.node().getBoundingClientRect().width;

        // Create Dataset with proper shape
        const lineData = {
            "dataByTopic": [
                {
                    "topic": -1,
                    "topicName": "Vivid",
                    "dates": [
                        {
                            "value": 0,
                            "date": "2016-08-01T00:00:00-07:00"
                        },
                        {
                            "value": 3,
                            "date": "2016-08-02T00:00:00-07:00"
                        },
                        {
                            "value": 1,
                            "date": "2016-08-03T00:00:00-07:00"
                        },
                        {
                            "value": 3,
                            "date": "2016-08-04T00:00:00-07:00"
                        },
                        {
                            "value": 3,
                            "date": "2016-08-05T00:00:00-07:00"
                        },
                        {
                            "value": 0,
                            "date": "2016-08-06T00:00:00-07:00"
                        },
                        {
                            "value": 1,
                            "date": "2016-08-07T00:00:00-07:00"
                        },
                        {
                            "value": 1,
                            "date": "2016-08-08T00:00:00-07:00"
                        },
                        {
                            "value": 0,
                            "date": "2016-08-09T00:00:00-07:00"
                        },
                        {
                            "value": 3,
                            "date": "2016-08-10T00:00:00-07:00"
                        },
                        {
                            "value": 4,
                            "date": "2016-08-11T00:00:00-07:00"
                        },
                        {
                            "value": 4,
                            "date": "2016-08-12T00:00:00-07:00"
                        },
                        {
                            "value": 2,
                            "date": "2016-08-13T00:00:00-07:00"
                        },
                        {
                            "value": 3,
                            "date": "2016-08-14T00:00:00-07:00"
                        },
                        {
                            "value": 0,
                            "date": "2016-08-15T00:00:00-07:00"
                        },
                        {
                            "value": 1,
                            "date": "2016-08-16T00:00:00-07:00"
                        },
                        {
                            "value": 0,
                            "date": "2016-08-17T00:00:00-07:00"
                        },
                        {
                            "value": 2,
                            "date": "2016-08-18T00:00:00-07:00"
                        },
                        {
                            "value": 5,
                            "date": "2016-08-19T00:00:00-07:00"
                        },
                        {
                            "value": 1,
                            "date": "2016-08-20T00:00:00-07:00"
                        },
                        {
                            "value": 2,
                            "date": "2016-08-21T00:00:00-07:00"
                        },
                        {
                            "value": 8,
                            "date": "2016-08-22T00:00:00-07:00"
                        },
                        {
                            "value": 4,
                            "date": "2016-08-23T00:00:00-07:00"
                        },
                        {
                            "value": 3,
                            "date": "2016-08-24T00:00:00-07:00"
                        },
                        {
                            "value": 2,
                            "date": "2016-08-25T00:00:00-07:00"
                        },
                        {
                            "value": 5,
                            "date": "2016-08-26T00:00:00-07:00"
                        }
                    ]
                }
            ]
        };

        // Configure chart
        lineChart
            .margin({bottom: 50})
            .height(400)
            .width(containerWidth);

        container.datum(lineData).call(lineChart);

        const redrawChart = () => {
            const newContainerWidth = container.node() ? container.node().getBoundingClientRect().width : false;

            // Setting the new width on the chart
            lineChart.width(newContainerWidth);

            // Rendering the chart again
            container.call(lineChart);
        };
        const throttledRedraw = _.throttle(redrawChart, 200);

        window.addEventListener("resize", throttledRedraw);
    </script>
</body>

</html>
